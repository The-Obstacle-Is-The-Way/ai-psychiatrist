# Artifact Namespace Registry

**Purpose**: Single source of truth for all data artifacts, scripts, and naming conventions
**Created**: 2025-12-23
**Status**: DRAFT - Identified during reproduction run

---

## Naming Convention Summary

| Prefix | Meaning | Example |
|--------|---------|---------|
| (none) | AVEC2017 official splits | `reference_embeddings.npz` |
| `paper_` | Paper-style custom splits | `paper_reference_embeddings.npz` |

---

## Data Splits

### AVEC2017 Official Splits (Default)

| File | Participants | Per-Item PHQ-8 | Usage |
|------|-------------|----------------|-------|
| `data/train_split_Depression_AVEC2017.csv` | 107 | Yes | Training/few-shot knowledge base |
| `data/dev_split_Depression_AVEC2017.csv` | 35 | Yes | Default evaluation |
| `data/test_split_Depression_AVEC2017.csv` | 47 | No | Competition (unusable for item MAE) |
| `data/full_test_split.csv` | 47 | Total only | Competition alt |

### Paper Custom Splits

| File | Participants | Per-Item PHQ-8 | Usage |
|------|-------------|----------------|-------|
| `data/paper_splits/paper_split_train.csv` | 58 | Yes | Paper-style knowledge base |
| `data/paper_splits/paper_split_val.csv` | 43 | Yes | Hyperparameter tuning |
| `data/paper_splits/paper_split_test.csv` | 41 | Yes | Paper reproduction evaluation |
| `data/paper_splits/paper_split_metadata.json` | - | - | Split provenance (seed, IDs) |

Note: the paper does not publish the exact split membership (participant IDs). These are
paper-style splits generated by `scripts/create_paper_split.py` (Appendix C algorithm) with a
user-chosen seed; the 58/43/41 counts match the paper.

---

## Embeddings Artifacts

| File | Source Split | Participants | Size | Created By |
|------|-------------|--------------|------|------------|
| `data/embeddings/reference_embeddings.npz` | AVEC-train | 107 | ~189 MB | `scripts/generate_embeddings.py --split avec-train` |
| `data/embeddings/reference_embeddings.json` | AVEC-train | 107 | ~5.5 MB | Written alongside by `scripts/generate_embeddings.py` |
| `data/embeddings/paper_reference_embeddings.npz` | Paper-train | 58 | ~101 MB | `scripts/generate_embeddings.py --split paper-train` |
| `data/embeddings/paper_reference_embeddings.json` | Paper-train | 58 | ~2.9 MB | Written alongside by `scripts/generate_embeddings.py` |

### Embedding Auto-Selection Logic

`scripts/reproduce_results.py` automatically selects embeddings based on `--split`:

```python
embeddings_path = data_settings.embeddings_path
if split.startswith("paper"):
    embeddings_path = data_settings.base_dir / "embeddings" / "paper_reference_embeddings.npz"
```

---

## Scripts

### Split Creation

| Script | Output | Purpose |
|--------|--------|---------|
| `scripts/create_paper_split.py` | `data/paper_splits/paper_split_*.csv` | Create paper-style 58/43/41 split |

### Embedding Generation

| Script | Input Split | Output | Purpose |
|--------|-------------|--------|---------|
| `scripts/generate_embeddings.py --split avec-train` | `train_split_Depression_AVEC2017.csv` | `reference_embeddings.*` | AVEC embeddings |
| `scripts/generate_embeddings.py --split paper-train` | `paper_split_train.csv` | `paper_reference_embeddings.*` | Paper embeddings |

### Reproduction

| Script | Eval Split | Embeddings Used | Purpose |
|--------|------------|-----------------|---------|
| `scripts/reproduce_results.py --split dev` | AVEC dev (35) | `reference_embeddings.*` | Default evaluation |
| `scripts/reproduce_results.py --split paper` | Paper test (41) | `paper_reference_embeddings.*` | Paper reproduction |

---

## Configuration Parameters

### Paper-Specified (Appendix D)

| Parameter | Value | Config Path |
|-----------|-------|-------------|
| `chunk_size` | 8 | `embedding.chunk_size` |
| `chunk_step` | 2 | `embedding.chunk_step` |
| `top_k_references` | 2 | `embedding.top_k_references` |
| `dimension` | 4096 | `embedding.dimension` |
| `max_iterations` | 10 | `feedback.max_iterations` |
| `score_threshold` | 3 | `feedback.score_threshold` |

### Implementation Defaults (GAP-001)

| Parameter | Value | Rationale |
|-----------|-------|-----------|
| `temperature` | 0.2 | "fairly deterministic" |
| `temperature_judge` | 0.0 | Deterministic for scoring |
| `top_k` | 20 | Ollama common default |
| `top_p` | 0.8 | Standard nucleus sampling |

---

## Output Artifacts

| File Pattern | Purpose |
|--------------|---------|
| `data/outputs/reproduction_results_*.json` | Raw reproduction results |
| `data/outputs/qualitative_*.json` | Qualitative assessment outputs |
| `data/outputs/meta_review_*.json` | Meta-review outputs |

---

## Friction Points / Improvements Needed

### 1. Naming Consistency Review

**Current State**: Mostly consistent with `paper_` prefix convention.

**Potential Issues**:
- [ ] `--split paper` vs `--split paper-test` - both work but confusing
- [ ] No explicit `avec_` prefix for AVEC artifacts (implied by absence)

### 2. Documentation Gaps

- [ ] Add inline comments to `src/ai_psychiatrist/config.py` referencing this registry
- [ ] Update `scripts/reproduce_results.py` help text with artifact mapping

### 3. Potential Improvements

- [ ] Consider adding `avec_` prefix for symmetry
- [ ] Add validation that correct embeddings exist before running

---

## See Also

- [data-splits-registry.md](./data-splits-registry.md) - Detailed split documentation
- [GAP-001](../bugs/gap-001-paper-unspecified-parameters.md) - Paper-unspecified parameters
- [BUG-018](../bugs/bug-018-reproduction-friction.md) - Reproduction friction log
